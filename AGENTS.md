# AGENTS.md

All text must be written in English.

## General rules

- **Dependencies**: Use **package.xml + rosdep** for ROS and system dependencies. Use **Poetry** (pyproject.toml) only for Python-only packages; do not add ROS packages to Poetry.
- **No AI/editor signatures anywhere**: Do not add, and do not leave in place, any signature or attribution that refers to an AI, agent, or editor (e.g. Cursor, Claude, Copilot). This applies to all project artifacts, including but not limited to:
  - Commit messages (no `Co-Authored-By: ...`, no trailer lines mentioning AI/agents).
  - Pull request titles and descriptions (no "Made with Cursor", "Generated by ...", "Powered by Cursor", or similar phrases in the body or title).
  - Source code, comments, and documentation.
  - Any other generated text (e.g. issue descriptions, release notes).  
    Before creating or finalizing a commit or PR, check the full text for such phrases and remove them.
- Before reading large-token files (images, videos, PDFs, etc.), always ask the user for confirmation first.
- When unused packages or source files (not referenced anywhere in the codebase) are found, proactively suggest their removal — but never delete them without user approval.
- **Co-MLOps**: When referring to the Co-MLOps proper noun (platform, concept, etc.), always spell it as **Co-MLOps** (hyphen, capital C, M, L, O; lowercase p, s).

## Security

- This repository is **public**. If any API tokens, personal access tokens, secrets, or credentials are found in source code, report them to the user immediately — this is a critical security risk.

## Coding style

### C/C++

- Always separate declarations into header files (`.h`/`.hpp`) and implementations into source files (`.c`/`.cpp`), except for the `main` entry point file.
- Always add a docstring (documentation comment) when defining functions, classes, or constants. In C/C++, use Doxygen-style comments (e.g. `/** ... */`) or equivalent.
- When changing source code, always update the corresponding docstring so that the documentation stays accurate.
- When changing source code, always update any corresponding documents (e.g. README, user docs, API docs) so that they reflect the change.

### Docker

- When writing a Dockerfile, minimize the final image size and build time (e.g., multi-stage builds, layer caching, minimal base images, combining RUN instructions).
- Proactively suggest optimizations whenever opportunities are found.

## Git and CI

### Commit and PR conventions

- Commit messages and PR titles must follow [Conventional Commits](https://www.conventionalcommits.org/) (e.g., `feat:`, `fix:`, `chore:`, `docs:`, `refactor:`, `test:`, `ci:`).
- **Do not add** "Made with Cursor", "Co-Authored-By", or any other AI/editor attribution to commit messages or PR titles/descriptions. Review the exact text before submitting.
- Commit messages and PR descriptions must include:
  - **Detailed description** of what was changed and why.
  - **How to verify** — steps or commands for reviewers to confirm the change works correctly.
  - **Improvements** — what this change improves.
  - **Limitations** — any known limitations or caveats (if applicable).

### Pre-commit

When editing files, always run pre-commit against all config files matching `.pre-commit-config*` and confirm there are no errors before committing. Run pre-commit with each config file:

```bash
pre-commit run --all-files -c .pre-commit-config.yaml
pre-commit run --all-files -c .pre-commit-config-optional.yaml
pre-commit run --all-files -c .pre-commit-config-ansible.yaml
```

### CI compatibility

When making changes, ensure the modified source code does not break existing GitHub workflows. This means writing code that passes existing CI checks — not modifying the workflows themselves to make them pass.

### Investigating workflow failures

When investigating why a GitHub Actions workflow is failing, use the `gh` CLI (or equivalent) to fetch and read the actual failing run logs instead of guessing. For example:

```bash
gh run list --limit 10
gh run view <run_id> --log-failed
```

Use the log output to identify the real error (e.g. missing command, wrong shell, permission) and fix the workflow or code accordingly.
